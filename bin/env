#!/bin/bash

DIR="$(dirname "$0")"
. "${DIR}/config"

export INSTANCE_IP=$(gcloud sql instances describe ${INSTANCE} \
    --format='value(ipAddresses[0].ipAddress)')

export CONF_FILE="${HOME}/.my.cnf"

cat > $CONF_FILE << EOF
[client]
port=3306
ssl-mode=VERIFY_CA
ssl-ca=${CONF_DIR}/ca.pem
ssl-cert=${CONF_DIR}/client.pem
ssl-key=${CONF_DIR}/client.key
EOF


echo "MySQL client configuration generated: ${CONF_FILE}"
echo "mysql -h ${INSTANCE_IP} -u root"